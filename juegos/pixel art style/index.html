<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AzDi Art Studio</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        :root { --main: #ff4fac; --bg: #f0f0f0; --text: #333; }
        body { margin: 0; background: var(--bg); font-family: 'Fredoka One', cursive; overflow: hidden; touch-action: none; }
        
        /* HEADER */
        header { height: 60px; background: white; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 10; position: relative; }
        .back-btn { background: var(--main); color: white; border: none; padding: 8px 15px; border-radius: 20px; }

        /* AREA DE DIBUJO */
        #viewport { width: 100vw; height: calc(100vh - 160px); display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
        #canvas-container { display: grid; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.1); border: 2px solid #ddd; transform-origin: center; transition: transform 0.1s ease-out; }
        
        .px { width: 40px; height: 40px; border: 0.5px solid #eee; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #ccc; user-select: none; }

        /* CONTROLES INFERIORES */
        #footer { height: 100px; background: white; border-top: 1px solid #ddd; display: flex; align-items: center; padding: 0 10px; gap: 10px; overflow-x: auto; scrollbar-width: none; }
        #footer::-webkit-scrollbar { display: none; }

        .color-item { min-width: 60px; height: 60px; border-radius: 50%; border: 4px solid #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); transition: 0.2s; flex-shrink: 0; position: relative; }
        .color-item.active { transform: scale(1.15) translateY(-10px); border-color: var(--main); }
        .color-item.done::after { content: '‚úì'; position: absolute; inset: 0; background: rgba(0,0,0,0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center; }

        /* MENU INICIAL */
        #home { position: fixed; inset: 0; background: white; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .menu-btn { width: 80%; max-width: 300px; padding: 20px; margin: 10px; border-radius: 30px; border: none; font-family: inherit; font-size: 1.2rem; color: white; cursor: pointer; }
    </style>
</head>
<body>

<div id="home">
    <h1 style="color:var(--main); font-size: 2.5rem; margin-bottom: 30px;">AZDI ART STUDIO</h1>
    <button class="menu-btn" style="background: var(--main);" onclick="startLevel(0)">üçÑ MARIO CLASSIC</button>
    <button class="menu-btn" style="background: #4facfe;" onclick="startLevel(1)">‚öîÔ∏è SWORD ADVENTURE</button>
    <button class="menu-btn" style="background: #ffb300;" onclick="startLevel(2)">üê§ YELLOW DUCK</button>
</div>

<div id="game" style="display:none;">
    <header>
        <button class="back-btn" onclick="location.reload()">VOLVER</button>
        <div id="lvl-name">NIVEL</div>
        <div id="progress">0%</div>
    </header>

    <div id="viewport">
        <div id="canvas-container"></div>
    </div>

    <div id="footer"></div>
</div>

<script>
    const COLORS = {
        1: "#FF4444", 2: "#000000", 3: "#FFEB3B", 4: "#2196F3", 
        5: "#FFCCBC", 6: "#795548", 7: "#4CAF50", 8: "#9C27B0"
    };

    const LEVELS = [
        { name: "MARIO", grid: [[0,1,1,1,0],[1,1,1,1,1],[6,5,2,5,5],[6,5,6,5,5],[0,5,5,5,0]] },
        { name: "ESPADA", grid: [[0,4,0],[4,4,4],[0,4,0],[0,6,0],[6,6,6]] },
        { name: "PATITO", grid: [[3,3,3,0],[3,3,3,8],[3,3,3,3],[0,3,3,0]] }
    ];

    let currentLevel = null;
    let selectedColor = 1;
    let scale = 1;

    // Iniciar Nivel
    function startLevel(idx) {
        document.getElementById('home').style.display = 'none';
        document.getElementById('game').style.display = 'block';
        currentLevel = LEVELS[idx];
        document.getElementById('lvl-name').textContent = currentLevel.name;
        
        renderGrid();
        renderPalette();
    }

    function renderGrid() {
        const container = document.getElementById('canvas-container');
        const matrix = currentLevel.grid;
        container.style.gridTemplateColumns = `repeat(${matrix[0].length}, 1fr)`;
        container.innerHTML = '';

        matrix.forEach((row, r) => {
            row.forEach((colorIdx, c) => {
                const px = document.createElement('div');
                px.className = 'px';
                px.dataset.target = colorIdx;
                if(colorIdx !== 0) px.textContent = colorIdx;
                px.onclick = () => paint(px);
                container.appendChild(px);
            });
        });
    }

    function renderPalette() {
        const footer = document.getElementById('footer');
        footer.innerHTML = '';
        
        // Sacar colores √∫nicos del dibujo
        const needed = [...new Set(currentLevel.grid.flat())].filter(c => c !== 0);
        
        needed.forEach(num => {
            const item = document.createElement('div');
            item.className = `color-item ${num == selectedColor ? 'active' : ''}`;
            item.style.backgroundColor = COLORS[num];
            item.textContent = num;
            item.onclick = () => {
                document.querySelectorAll('.color-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                selectedColor = num;
            };
            footer.appendChild(item);
        });
    }

    function paint(px) {
        if(px.dataset.target == selectedColor) {
            px.style.backgroundColor = COLORS[selectedColor];
            px.textContent = '';
            px.dataset.done = "true";
            px.style.borderColor = COLORS[selectedColor];
            checkProgress();
        } else {
            // Vibrar o efecto error
            px.style.background = "#ffe0e0";
            setTimeout(() => px.style.background = "white", 200);
        }
    }

    function checkProgress() {
        const all = document.querySelectorAll('.px[data-target]:not([data-target="0"])');
        const done = document.querySelectorAll('.px[data-done="true"]');
        const p = Math.floor((done.length / all.length) * 100);
        document.getElementById('progress').textContent = p + "%";
        
        if(p === 100) {
            alert("¬°INCRE√çBLE, TANIA! Lo has pintado perfecto. üé®");
        }
    }

    // Zoom b√°sico con scroll/rueda
    document.getElementById('viewport').onwheel = (e) => {
        e.preventDefault();
        scale += e.deltaY * -0.001;
        scale = Math.min(Math.max(.5, scale), 3);
        document.getElementById('canvas-container').style.transform = `scale(${scale})`;
    };
</script>
</body>
</html>
