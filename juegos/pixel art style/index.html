<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AzDi Art Studio</title>

<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
--primary:#ff4fac;
--secondary:#4facfe;
--dark:#0a0a0a;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}

html,body{
margin:0;height:100%;
background:#0a0a0a;
font-family:Poppins;
color:white;
overflow:hidden;
}

/* SPLASH */
#splash{
position:fixed;inset:0;
display:flex;align-items:center;justify-content:center;
background:#0a0a0a;z-index:5;
font-family:"Luckiest Guy";
font-size:3rem;
background:linear-gradient(45deg,#ff4fac,#4facfe);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

/* MENU */
#menu{display:none;height:100%;padding:20px;overflow:auto}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:20px}
.card{background:#1a1a1a;border-radius:18px;padding:15px;text-align:center;cursor:pointer;border:2px solid #333}
.card:hover{border-color:var(--primary)}

.title{font-family:"Luckiest Guy";color:var(--secondary);margin:20px 0}

/* GAME */
#game{display:none;height:100%;flex-direction:column}

header{
height:70px;background:#252525;
display:flex;align-items:center;justify-content:space-between;
padding:0 20px;border-bottom:3px solid var(--primary)
}

.btn{
background:var(--primary);
border:none;color:white;padding:10px 18px;border-radius:20px;
font-family:"Luckiest Guy";cursor:pointer
}

.view{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden}

#canvas-wrapper{
display:grid;
background:white;
touch-action:none;
transform-origin:center;
}

.pixel{
width:40px;height:40px;
display:flex;align-items:center;justify-content:center;
font-size:12px;font-weight:bold;color:#ccc;
border:1px solid rgba(0,0,0,.05);
touch-action:none;
}

.controls{
height:150px;background:white;padding:12px;
display:flex;flex-direction:column;gap:10px
}

.palette{display:flex;gap:12px;overflow:auto}

.color{
min-width:55px;height:55px;border-radius:50%;
border:4px solid white;cursor:pointer;
display:flex;align-items:center;justify-content:center;
font-family:"Luckiest Guy";color:white;text-shadow:1px 1px 2px #000
}
.color.active{transform:scale(1.15);border-color:var(--primary)}

.tools{display:flex;justify-content:center;gap:10px}
.tool{padding:6px 18px;border-radius:12px;border:none;background:#eee;font-weight:bold}
.tool.active{background:var(--secondary);color:white}
</style>
</head>

<body>

<div id="splash">AZDI STUDIO</div>

<div id="menu">
<div class="title">DIBUJOS</div>
<div id="levels" class="grid"></div>

<div class="title">LIBRE</div>
<div class="grid">
<div class="card" onclick="freeMode(20)">20x20</div>
<div class="card" onclick="freeMode(40)">40x40</div>
</div>
</div>

<div id="game">
<header>
<button class="btn" onclick="location.reload()">SALIR</button>
<div id="percent">0%</div>
<button class="btn" onclick="resetZoom()">CENTRAR</button>
</header>

<div class="view" id="view"><div id="canvas-wrapper"></div></div>

<div class="controls">
<div class="tools">
<button id="pen" class="tool active" onclick="setTool('pen')">PINCEL</button>
<button id="move" class="tool" onclick="setTool('move')">MOVER</button>
</div>
<div id="palette" class="palette"></div>
</div>
</div>

<script>
/* =========================
   CONFIGURACION GENERAL
========================= */

const DRAW_COLORS = [
"#000000","#7f7f7f","#c0c0c0","#ffffff",
"#ff0000","#ff7f00","#ffff00","#00ff00","#00ffff","#0000ff","#8b00ff",
"#ff69b4","#a52a2a","#deb887","#f4a460","#ffd700","#98fb98","#20b2aa",
"#87cefa","#4682b4","#dda0dd","#ffb6c1"
];

const NUMBER_COLORS={
1:"#FF3B30",2:"#000000",3:"#FFCC00",4:"#007AFF",5:"#4CD964",
6:"#5856D6",7:"#FF9500",8:"#FF2D55",9:"#AF52DE",10:"#5AC8FA",
11:"#FFFFFF",12:"#8E8E93",13:"#5E5E5E",14:"#FFCCBC",15:"#8B4513"
};

/* =========================
   NIVELES (AÑADE AQUÍ LOS QUE QUIERAS)
========================= */

const LEVELS=[
{name:"SETAS",grid:[
[0,1,1,1,0],
[1,14,14,14,1],
[1,14,2,14,1],
[0,1,1,1,0]
]},
{name:"FANTASMA",grid:[
[0,3,3,3,0],
[3,3,2,3,3],
[3,3,3,3,3],
[3,2,3,2,3],
[3,3,3,3,3]
]},
{name:"CORAZON",grid:[
[0,8,0,8,0],
[8,8,8,8,8],
[8,8,8,8,8],
[0,8,8,8,0],
[0,0,8,0,0]
]},
{name:"HELADO",grid:[
[0,7,7,7,0],
[7,7,7,7,7],
[7,7,7,7,7],
[0,15,15,15,0],
[0,15,15,15,0]
]},
{name:"CARITA",grid:[
[0,3,3,3,0],
[3,2,3,2,3],
[3,3,3,3,3],
[3,3,3,3,3],
[0,3,3,3,0]
]}
];

/* =========================
   ESTADO
========================= */

let mode="numbers"; // numbers | free
let tool="pencil";
let brushSize=1;
let selectedColor="#000000";
let painting=false;

/* =========================
   MENU AUTOMATICO
========================= */

window.onload=()=>{
setTimeout(()=>{
splash.style.display="none";
menu.style.display="block";
},700);

const container=document.getElementById("levels");
LEVELS.forEach((lvl,i)=>{
container.innerHTML+=`<div class="card" onclick="startLevel(${i})">${lvl.name}</div>`;
});
};

/* =========================
   INICIAR NIVELES
========================= */

function startLevel(i){
mode="numbers";
menu.style.display="none";
game.style.display="flex";
buildNumbers(LEVELS[i].grid);
buildNumberPalette(LEVELS[i].grid);
}

function freeMode(size){
mode="free";
menu.style.display="none";
game.style.display="flex";
let grid=Array(size).fill().map(()=>Array(size).fill("#ffffff"));
buildFree(grid);
buildFreePalette();
}

/* =========================
   PINTAR POR NUMEROS
========================= */

function buildNumbers(grid){
const wrap=canvas-wrapper;
wrap.innerHTML="";
wrap.style.gridTemplateColumns=`repeat(${grid[0].length},40px)`;

grid.forEach(row=>{
row.forEach(v=>{
let d=document.createElement("div");
d.className="pixel";
if(v!==0){
d.dataset.target=v;
d.textContent=v;
d.style.background="#fff";
}
d.onpointerdown=()=>paintNumber(d);
wrap.appendChild(d);
});
});
}

function paintNumber(px){
if(Number(px.dataset.target)===Number(selectedColor)){
px.style.background=NUMBER_COLORS[selectedColor];
px.textContent="";
px.dataset.done=1;
updateProgress();
}
}

function updateProgress(){
let t=document.querySelectorAll(".pixel[data-target]").length;
let d=document.querySelectorAll(".pixel[data-done]").length;
percent.textContent=Math.floor(d/t*100)+"%";
}

function buildNumberPalette(grid){
palette.innerHTML="";
let list=[...new Set(grid.flat())].filter(v=>v!=0);
list.forEach(n=>{
let c=document.createElement("div");
c.className="color";
c.style.background=NUMBER_COLORS[n];
c.textContent=n;
c.onclick=()=>selectNumberColor(n,c);
palette.appendChild(c);
});
}

function selectNumberColor(n,el){
document.querySelectorAll(".color").forEach(e=>e.classList.remove("active"));
el.classList.add("active");
selectedColor=n;
}

/* =========================
   MODO LIBRE (BROCHA)
========================= */

function buildFree(grid){
const wrap=canvas-wrapper;
wrap.innerHTML="";
wrap.style.gridTemplateColumns=`repeat(${grid[0].length},20px)`;

grid.forEach((row,y)=>{
row.forEach((v,x)=>{
let d=document.createElement("div");
d.className="pixel";
d.style.background=v;
d.dataset.x=x;
d.dataset.y=y;

d.onpointerdown=()=>{painting=true;paintFree(x,y)};
d.onpointerenter=()=>painting&&paintFree(x,y);

wrap.appendChild(d);
});
});

window.onpointerup=()=>painting=false;
}

function paintFree(x,y){
let pixels=document.querySelectorAll(".pixel");
pixels.forEach(p=>{
let dx=p.dataset.x-x;
let dy=p.dataset.y-y;
if(Math.sqrt(dx*dx+dy*dy)<=brushSize)
p.style.background=selectedColor;
});
}

/* =========================
   PALETA LIBRE
========================= */

function buildFreePalette(){
palette.innerHTML="";

DRAW_COLORS.forEach(col=>{
let c=document.createElement("div");
c.className="color";
c.style.background=col;
c.onclick=()=>{
document.querySelectorAll(".color").forEach(e=>e.classList.remove("active"));
c.classList.add("active");
selectedColor=col;
};
palette.appendChild(c);
});

/* herramientas */
palette.innerHTML+=`
<div style="display:flex;gap:10px;margin-left:20px">
<button onclick="tool='pencil'">Lápiz</button>
<button onclick="tool='brush'">Brocha</button>
<input type="range" min="1" max="4" value="1" onchange="brushSize=this.value">
</div>`;
}

</script>

</body>
</html>
