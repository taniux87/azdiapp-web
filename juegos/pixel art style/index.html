<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AzDi Pixel Studio</title>
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #1a1a1a; --pink: #ff4fac; --font: 'Luckiest Guy', cursive; }
        body { margin: 0; background: var(--bg); font-family: var(--font); color: white; overflow: hidden; }
        
        /* Men√∫ Inicial */
        #menu { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; }
        
        /* Contenedor Principal */
        #app { display: none; height: 100vh; flex-direction: column; }
        #header { height: 60px; background: #333; display: flex; justify-content: space-around; align-items: center; border-bottom: 3px solid var(--pink); }
        
        #canvas-area { flex: 1; display: flex; align-items: center; justify-content: center; overflow: auto; padding: 20px; background: #222; }
        #grid { display: grid; gap: 1px; background: #444; border: 5px solid #fff; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        
        .pixel { width: 30px; height: 30px; background: #eee; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #ccc; }

        /* Paleta */
        #footer { height: 100px; background: #333; display: flex; align-items: center; justify-content: center; gap: 10px; padding: 0 10px; overflow-x: auto; }
        .color-btn { width: 45px; height: 45px; border-radius: 10px; border: 3px solid #fff; flex-shrink: 0; }
        .color-btn.active { transform: translateY(-10px); border-color: var(--pink); box-shadow: 0 5px 15px var(--pink); }

        .btn { background: var(--pink); color: white; border: none; padding: 15px 30px; border-radius: 50px; font-family: var(--font); font-size: 18px; cursor: pointer; box-shadow: 0 4px 0 #b02e75; }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        
        #win-msg { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="menu">
    <h1 style="color:var(--pink); font-size: 40px;">AZDI PIXEL STUDIO</h1>
    <button class="btn" onclick="startApp('library')">üìö ELEGIR DIBUJO</button>
    <button class="btn" style="background:#4facfe; box-shadow: 0 4px 0 #2a80c0;" onclick="startApp('free')">üé® DIBUJO LIBRE</button>
</div>

<div id="app">
    <div id="header">
        <button class="btn" style="padding: 5px 15px; font-size: 12px;" onclick="location.reload()">‚¨Ö VOLVER</button>
        <div id="mode-title">MODO</div>
        <div id="stats">100%</div>
    </div>

    <div id="canvas-area">
        <div id="grid"></div>
    </div>

    <div id="footer"></div>
</div>

<div id="win-msg">
    <h1>¬°OBRA MAESTRA! üèÜ</h1>
    <button class="btn" onclick="location.reload()">CONTINUAR</button>
</div>

<script>
    const COLORS = {
        0: "#ffffff", 1: "#ff0000", 2: "#000000", 3: "#ffff00", 
        4: "#0000ff", 5: "#ffdbac", 6: "#8b4513", 7: "#00ff00", 8: "#ff00ff"
    };

    const LIBRARY = [
        {
            name: "MARIO",
            grid: [
                [0,1,1,1,1,0],
                [1,1,1,1,1,1],
                [6,6,6,5,5,2],
                [6,5,6,5,5,5],
                [0,5,5,5,5,0]
            ]
        },
        {
            name: "FANTASMA",
            grid: [
                [0,0,2,2,2,0,0],
                [0,2,0,0,0,2,0],
                [2,0,2,0,2,0,2],
                [2,0,0,0,0,0,2],
                [2,2,2,2,2,2,2]
            ]
        }
    ];

    let currentMode = '';
    let selectedColor = 1;

    function startApp(mode) {
        currentMode = mode;
        document.getElementById('menu').style.display = 'none';
        document.getElementById('app').style.display = 'flex';
        
        if (mode === 'library') {
            loadDrawing(LIBRARY[Math.floor(Math.random() * LIBRARY.length)]);
        } else {
            loadFreeMode();
        }
    }

    function loadDrawing(drawing) {
        document.getElementById('mode-title').textContent = drawing.name;
        const gridUI = document.getElementById('grid');
        gridUI.style.gridTemplateColumns = `repeat(${drawing.grid[0].length}, 1fr)`;
        gridUI.innerHTML = '';

        drawing.grid.forEach((row, r) => {
            row.forEach((colorIdx, c) => {
                const pixel = document.createElement('div');
                pixel.className = 'pixel';
                pixel.dataset.target = colorIdx;
                pixel.dataset.current = "-1";
                if(colorIdx !== 0) pixel.textContent = colorIdx; // Ayuda visual
                pixel.onclick = () => {
                    if (selectedColor == colorIdx) {
                        pixel.style.backgroundColor = COLORS[colorIdx];
                        pixel.dataset.current = colorIdx;
                        pixel.textContent = "";
                        checkWin();
                    } else {
                        pixel.style.background = "#ffcccc";
                        setTimeout(() => pixel.style.background = "#eee", 200);
                    }
                };
                gridUI.appendChild(pixel);
            });
        });
        setupPalette(Object.keys(COLORS));
    }

    function loadFreeMode() {
        document.getElementById('mode-title').textContent = "DIBUJO LIBRE";
        const gridUI = document.getElementById('grid');
        gridUI.style.gridTemplateColumns = `repeat(15, 1fr)`;
        gridUI.innerHTML = '';

        for (let i = 0; i < 225; i++) {
            const pixel = document.createElement('div');
            pixel.className = 'pixel';
            pixel.style.width = "22px"; pixel.style.height = "22px";
            pixel.onclick = () => pixel.style.backgroundColor = COLORS[selectedColor];
            gridUI.appendChild(pixel);
        }
        setupPalette(Object.keys(COLORS));
    }

    function setupPalette(colorIndices) {
        const footer = document.getElementById('footer');
        footer.innerHTML = '';
        colorIndices.forEach(idx => {
            const btn = document.createElement('div');
            btn.className = 'color-btn';
            btn.style.backgroundColor = COLORS[idx];
            btn.onclick = () => {
                document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedColor = idx;
            };
            footer.appendChild(btn);
        });
    }

    function checkWin() {
        const pixels = document.querySelectorAll('.pixel');
        let win = true;
        pixels.forEach(p => {
            if (p.dataset.target && p.dataset.target != "0" && p.dataset.current != p.dataset.target) win = false;
        });
        if (win) document.getElementById('win-msg').style.display = 'flex';
    }
</script>
</body>
</html>
