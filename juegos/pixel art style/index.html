<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>AzDi Pixel Art Style</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
margin:0;
background:#222;
font-family:Poppins;
color:white;
overflow:hidden;
}

/* CANVAS */
#canvas{
position:absolute;
top:0;left:0;
touch-action:none;
}

/* PANEL */
#panel{
position:fixed;
bottom:0;left:0;right:0;
background:#f0f0f0;
color:black;
padding:8px;
display:flex;
flex-direction:column;
gap:6px;
}

.row{display:flex;gap:6px;overflow-x:auto}

.color{
width:36px;height:36px;border-radius:50%;
border:2px solid white;cursor:pointer;flex:0 0 auto;
}
.color.active{border:2px solid black;transform:scale(1.2)}

button{
border:none;padding:8px 12px;border-radius:12px;font-weight:bold;
background:#ff4fac;color:white;
}

.tools button.active{background:#4facfe}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<div id="panel">

<div class="row tools">
<button data-tool="pencil">Lápiz</button>
<button data-tool="marker">Rotulador</button>
<button data-tool="spray">Spray</button>
<button data-tool="water">Acuarela</button>
<button data-tool="eraser">Borrar</button>
<button onclick="clearCanvas()">Limpiar</button>
<button onclick="saveImage()">Guardar</button>
</div>

<input type="range" id="size" min="2" max="60" value="10">

<div class="row" id="palette"></div>

</div>

<script>

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
ctx.imageSmoothingEnabled=true;
canvas.style.touchAction="none";
const palette=document.getElementById("palette");

let drawing=false;
let color="#000";
let tool="pencil";
let lastX=0,lastY=0;

/* ===== CANVAS ===== */
function resize(){
canvas.width=window.innerWidth;
canvas.height=window.innerHeight-140;
ctx.fillStyle="#fff";
ctx.fillRect(0,0,canvas.width,canvas.height);
ctx.lineCap="round";
ctx.lineJoin="round";
}
window.addEventListener("resize",resize);
resize();

/* ===== POSICION REAL ===== */
function pos(e){
const r=canvas.getBoundingClientRect();
return [e.clientX-r.left,e.clientY-r.top];
}

/* ===== INTERPOLACIÓN SUAVE ===== */
function drawLine(x0,y0,x1,y1,size){
const dist=Math.hypot(x1-x0,y1-y0);
const steps=Math.max(1,dist/2);

for(let i=0;i<steps;i++){
const t=i/steps;
const x=x0+(x1-x0)*t;
const y=y0+(y1-y0)*t;
ctx.beginPath();
ctx.arc(x,y,size/2,0,Math.PI*2);
ctx.fill();
}
}

/* ===== INPUT ===== */
canvas.addEventListener("pointerdown",e=>{
e.preventDefault();
canvas.setPointerCapture(e.pointerId);
drawing=true;
[lastX,lastY]=pos(e);
paint(e);
});

canvas.addEventListener("pointermove",e=>{
if(!drawing) return;
e.preventDefault();
paint(e);
});

canvas.addEventListener("pointerup",e=>{
drawing=false;
canvas.releasePointerCapture(e.pointerId);
});

canvas.addEventListener("pointercancel",()=>drawing=false);/* ===== DIBUJO ===== */
function paint(e){
const [x,y]=pos(e);
const size=document.getElementById("size").value;

if(tool==="eraser"){
ctx.globalCompositeOperation="destination-out";
ctx.fillStyle="rgba(0,0,0,1)";
drawLine(lastX,lastY,x,y,size);
ctx.globalCompositeOperation="source-over";
}

else if(tool==="pencil"){
ctx.fillStyle=color;
drawLine(lastX,lastY,x,y,2);
}

else if(tool==="marker"){
ctx.fillStyle=color;
drawLine(lastX,lastY,x,y,size);
}

else if(tool==="spray"){
for(let i=0;i<25;i++){
const a=Math.random()*Math.PI*2;
const r=Math.random()*size;
ctx.fillStyle=color;
ctx.fillRect(x+Math.cos(a)*r,y+Math.sin(a)*r,1,1);
}
}

else if(tool==="water"){
ctx.globalAlpha=0.08;
ctx.fillStyle=color;
drawLine(lastX,lastY,x,y,size*1.4);
ctx.globalAlpha=1;
}

[lastX,lastY]=[x,y];
}
/* ===== PALETAS GRANDES ===== */

const palettes = {

basico:[
"#000000","#202020","#404040","#606060","#808080","#a0a0a0","#c0c0c0","#e0e0e0","#ffffff",
"#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff",
"#800000","#008000","#000080","#808000","#800080","#008080"
],

arcoiris:[
"#ff0000","#ff4000","#ff8000","#ffbf00","#ffff00","#bfff00","#80ff00","#40ff00",
"#00ff00","#00ff40","#00ff80","#00ffbf","#00ffff","#00bfff","#0080ff","#0040ff",
"#0000ff","#4000ff","#8000ff","#bf00ff","#ff00ff","#ff00bf","#ff0080","#ff0040"
],

pastel:[
"#ffd1dc","#ffe4e1","#fffacd","#e0ffff","#e6e6fa","#f0fff0","#fafad2","#f5deb3",
"#ffc0cb","#e0b0ff","#d8bfd8","#ffb6c1","#ffe4b5","#faf0e6","#f0ffff","#f5f5dc",
"#fff0f5","#e3f2fd","#fce4ec","#f3e5f5"
],

neon:[
"#ff00ff","#00ffff","#39ff14","#ff073a","#ff6ec7","#00f5ff","#fffb00","#ff1493",
"#00ffea","#ff5f1f","#7fff00","#00ff9f","#ff00aa","#00e5ff","#ffea00","#ff3300",
"#66ff00","#cc00ff","#00ffcc","#ffcc00"
],

piel:[
"#fff5e1","#ffe0bd","#ffcd94","#eac086","#d1a17a","#b97a56","#8d5524","#7a4b2a",
"#c68642","#a56b46","#5c3b21","#3d2b1f","#f6d7c3","#fcd5b5","#e0ac69","#c68642"
],

naturaleza:[
"#2e8b57","#3cb371","#66cdaa","#8fbc8f","#556b2f","#6b8e23","#228b22","#9acd32",
"#32cd32","#7cfc00","#006400","#8f9779","#4f7942","#3a5f0b","#355e3b","#4b5320"
],

cielo_mar:[
"#87ceeb","#00bfff","#1e90ff","#4682b4","#5f9ea0","#00ced1","#20b2aa","#40e0d0",
"#48d1cc","#00ffff","#b0e0e6","#add8e6","#87cefa","#4682b4","#5dade2","#85c1e9"
],

dulces:[
"#ff9aa2","#ffb7b2","#ffdac1","#e2f0cb","#b5ead7","#c7ceea","#f6abb6","#fcd5ce",
"#fae1dd","#e4c1f9","#d0f4de","#a9def9","#fcf6bd","#ffc8dd","#ffafcc","#f1c0e8"
],

fantasia:[
"#ff00ff","#cc00ff","#9900ff","#6600ff","#3300ff","#0033ff","#0066ff","#0099ff",
"#00ccff","#00ffff","#00ffcc","#00ff99","#00ff66","#33ff33","#66ff00","#99ff00"
],

tierra:[
"#3b2f2f","#4b3621","#654321","#8b4513","#a0522d","#cd853f","#d2b48c","#deb887",
"#f4a460","#daa520","#b8860b","#c2b280","#e5c07b","#d7b899","#c19a6b","#967969"
],

hielo:[
"#e0ffff","#d0f0ff","#c0e8ff","#b0e0ff","#a0d8ff","#90d0ff","#80c8ff","#70c0ff",
"#60b8ff","#50b0ff","#40a8ff","#309fff","#2097ff","#108fff","#0087ff","#0077e6"
]

};


/* ===== CREAR SELECTOR DE PALETAS (SEGURO PARA MOVIL) ===== */

window.addEventListener("load",()=>{

const paletteBar=document.getElementById("palette");

const selector=document.createElement("div");
selector.style.display="flex";
selector.style.gap="6px";
selector.style.overflowX="auto";
selector.style.marginBottom="6px";

paletteBar.parentNode.insertBefore(selector,paletteBar);

Object.keys(palettes).forEach(name=>{
let b=document.createElement("button");
b.textContent=name;
b.style.background="#ddd";
b.style.color="black";
b.style.borderRadius="8px";
b.style.padding="6px 10px";
b.onclick=()=>loadPalette(name);
selector.appendChild(b);
});

loadPalette("basico");

});


/* ===== FUNCION CARGAR PALETA ===== */

function loadPalette(name){
const paletteBar=document.getElementById("palette");
paletteBar.innerHTML="";

palettes[name].forEach(c=>{
let d=document.createElement("div");
d.className="color";
d.style.background=c;

d.onclick=()=>{
color=c;
document.querySelectorAll(".color").forEach(el=>el.classList.remove("active"));
d.classList.add("active");
};

paletteBar.appendChild(d);
});
}

loadPalette("basico");

/* BOTONES HERRAMIENTA */
document.querySelectorAll(".tools button[data-tool]").forEach(b=>{
b.onclick=()=>{
tool=b.dataset.tool;
document.querySelectorAll(".tools button").forEach(x=>x.classList.remove("active"));
b.classList.add("active");
};
});

/* UTIL */
function clearCanvas(){
ctx.fillStyle="#fff";
ctx.fillRect(0,0,canvas.width,canvas.height);
}

function saveImage(){
const link=document.createElement("a");
link.download="dibujo.png";
link.href=canvas.toDataURL();
link.click();
}

</script>
</body>
</html>
