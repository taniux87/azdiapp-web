<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AzDi Art Studio</title>

<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
--primary:#ff4fac;
--secondary:#4facfe;
--dark:#0a0a0a;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}

html,body{
margin:0;height:100%;
background:#0a0a0a;
font-family:Poppins;
color:white;
overflow:hidden;
}

/* SPLASH */
#splash{
position:fixed;inset:0;
display:flex;align-items:center;justify-content:center;
background:#0a0a0a;z-index:5;
font-family:"Luckiest Guy";
font-size:3rem;
background:linear-gradient(45deg,#ff4fac,#4facfe);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

/* MENU */
#menu{display:none;height:100%;padding:20px;overflow:auto}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:20px}
.card{background:#1a1a1a;border-radius:18px;padding:15px;text-align:center;cursor:pointer;border:2px solid #333}
.card:hover{border-color:var(--primary)}

.title{font-family:"Luckiest Guy";color:var(--secondary);margin:20px 0}

/* GAME */
#game{display:none;height:100%;flex-direction:column}

header{
height:70px;background:#252525;
display:flex;align-items:center;justify-content:space-between;
padding:0 20px;border-bottom:3px solid var(--primary)
}

.btn{
background:var(--primary);
border:none;color:white;padding:10px 18px;border-radius:20px;
font-family:"Luckiest Guy";cursor:pointer
}

.view{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden}

#canvas-wrapper{
display:grid;
background:white;
touch-action:none;
transform-origin:center;
}

.pixel{
width:40px;height:40px;
display:flex;align-items:center;justify-content:center;
font-size:12px;font-weight:bold;color:#ccc;
border:1px solid rgba(0,0,0,.05);
touch-action:none;
}

.controls{
height:150px;background:white;padding:12px;
display:flex;flex-direction:column;gap:10px
}

.palette{display:flex;gap:12px;overflow:auto}

.color{
min-width:55px;height:55px;border-radius:50%;
border:4px solid white;cursor:pointer;
display:flex;align-items:center;justify-content:center;
font-family:"Luckiest Guy";color:white;text-shadow:1px 1px 2px #000
}
.color.active{transform:scale(1.15);border-color:var(--primary)}

.tools{display:flex;justify-content:center;gap:10px}
.tool{padding:6px 18px;border-radius:12px;border:none;background:#eee;font-weight:bold}
.tool.active{background:var(--secondary);color:white}
</style>
</head>

<body>

<div id="splash">AZDI STUDIO</div>

<div id="menu">
<div class="title">DIBUJOS</div>
<div id="levels" class="grid"></div>

<div class="title">LIBRE</div>
<div class="grid">
<div class="card" onclick="freeMode(20)">20x20</div>
<div class="card" onclick="freeMode(40)">40x40</div>
</div>
</div>

<div id="game">
<header>
<button class="btn" onclick="location.reload()">SALIR</button>
<div id="percent">0%</div>
<button class="btn" onclick="resetZoom()">CENTRAR</button>
</header>

<div class="view" id="view"><div id="canvas-wrapper"></div></div>

<div class="controls">
<div class="tools">
<button id="pen" class="tool active" onclick="setTool('pen')">PINCEL</button>
<button id="move" class="tool" onclick="setTool('move')">MOVER</button>
</div>
<div id="palette" class="palette"></div>
</div>
</div>

<script>
const COLORS={
1:"#FF3B30",2:"#000000",3:"#FFCC00",4:"#007AFF",5:"#4CD964",
6:"#5856D6",7:"#FF9500",8:"#FF2D55",9:"#AF52DE",10:"#5AC8FA",
11:"#FFFFFF",12:"#8E8E93",13:"#5E5E5E",14:"#FFCCBC",15:"#8B4513"
};

const LEVELS=[
{name:"MARIO",grid:[[0,1,1,1,0],[1,14,14,14,1],[1,14,2,14,1],[0,1,1,1,0]]},
{name:"PACMAN",grid:[[0,3,3,0],[3,3,2,3],[3,3,3,3],[0,3,3,0]]}
];

let selected=1,tool="pen",painting=false,free=false;
let tx=0,ty=0,zoom=1,drag=false,lastX,lastY;

/* INIT */
window.onload=()=>{
setTimeout(()=>{
document.getElementById("splash").style.display="none";
document.getElementById("menu").style.display="block";
},900);

const levels=document.getElementById("levels");
LEVELS.forEach((l,i)=>{
levels.innerHTML+=`<div class="card" onclick="start(${i})">${l.name}</div>`;
});
};

function start(i){
free=false;
document.getElementById("menu").style.display="none";
document.getElementById("game").style.display="flex";
build(LEVELS[i].grid);
paletteBuild(LEVELS[i].grid);
}

function freeMode(size){
free=true;
document.getElementById("menu").style.display="none";
document.getElementById("game").style.display="flex";
let g=Array(size).fill().map(()=>Array(size).fill(11));
build(g);
paletteBuild(null,true);
}

function build(grid){
const wrap=document.getElementById("canvas-wrapper");
wrap.innerHTML="";
wrap.style.gridTemplateColumns=`repeat(${grid[0].length},40px)`;

grid.forEach(row=>{
row.forEach(v=>{
let d=document.createElement("div");
d.className="pixel";

if(!free&&v!==0){
d.dataset.target=v;
d.textContent=v;
d.style.background="#fff";
}else d.style.background=COLORS[v]||"#fff";

d.onpointerdown=()=>{painting=true;paint(d)};
d.onpointerenter=()=>painting&&paint(d);

wrap.appendChild(d);
});
});
}

window.onpointerup=()=>painting=false;

function paint(px){
if(tool!=="pen")return;

if(free){px.style.background=COLORS[selected];return;}

if(Number(px.dataset.target)===selected){
px.style.background=COLORS[selected];
px.textContent="";
px.dataset.done=1;
update();
}
}

function update(){
let t=document.querySelectorAll(".pixel[data-target]").length;
let d=document.querySelectorAll(".pixel[data-done]").length;
document.getElementById("percent").textContent=Math.floor(d/t*100)+"%";
}

function paletteBuild(grid,all=false){
const pal=document.getElementById("palette");
pal.innerHTML="";
let list=all?Object.keys(COLORS):[...new Set(grid.flat())].filter(v=>v!=0);

list.forEach(n=>{
let c=document.createElement("div");
c.className="color";
c.style.background=COLORS[n];
c.textContent=n;
if(n==selected)c.classList.add("active");
c.onclick=()=>{
document.querySelectorAll(".color").forEach(e=>e.classList.remove("active"));
c.classList.add("active");
selected=Number(n);
};
pal.appendChild(c);
});
}

function setTool(t){
tool=t;
document.querySelectorAll(".tool").forEach(b=>b.classList.remove("active"));
document.getElementById(t).classList.add("active");
}

document.getElementById("view").onpointerdown=e=>{
if(tool!=="move")return;
drag=true;lastX=e.clientX;lastY=e.clientY;
};

window.onpointermove=e=>{
if(!drag)return;
tx+=e.clientX-lastX;ty+=e.clientY-lastY;
lastX=e.clientX;lastY=e.clientY;
transform();
};

window.onpointerup=()=>drag=false;

document.getElementById("view").onwheel=e=>{
e.preventDefault();
zoom+=e.deltaY*-0.001;
zoom=Math.min(Math.max(.3,zoom),4);
transform();
};

function transform(){
document.getElementById("canvas-wrapper").style.transform=`translate(${tx}px,${ty}px) scale(${zoom})`;
}

function resetZoom(){tx=0;ty=0;zoom=1;transform()}
</script>

</body>
</html>
