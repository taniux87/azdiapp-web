<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Mundo Interactivo - Test</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    <style> body { margin: 0; overflow: hidden; background: #222; } </style>
</head>
<body>

<script>
const config = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    physics: { default: 'arcade', arcade: { debug: false } },
    scene: { preload: preload, create: create, update: update }
};

const game = new Phaser.Game(config);
let player;
let cursors;
let facing = 1;
    
function preload() {
    // Aquí podrías cargar tus propios dibujos
    // Ejemplo: this.load.image('avatar', 'tu-foto.png');
}

function create() {

    // Mundo grande
    this.cameras.main.setBounds(0, 0, 2000, 2000);
    this.physics.world.setBounds(0, 0, 2000, 2000);

    // Cuadrícula suelo
    let graphics = this.add.graphics();
    graphics.lineStyle(2, 0x444444, 1);
    for(let i=0; i<2000; i+=100) {
        graphics.moveTo(i, 0); graphics.lineTo(i, 2000);
        graphics.moveTo(0, i); graphics.lineTo(2000, i);
    }
    graphics.strokePath();


    /* =====================
       CREAR AVATAR
    ===================== */

    // Contenedor (el jugador real)
    player = this.add.container(400, 300);
    this.physics.add.existing(player);

    player.body.setSize(40, 70);
    player.body.setCollideWorldBounds(true);


    // SOMBRA
    let shadow = this.add.ellipse(0, 28, 40, 18, 0x000000, 0.25);

    // CUERPO
    let body = this.add.rectangle(0, 10, 30, 40, 0x4aa3ff);

    // CABEZA
    let head = this.add.circle(0, -25, 18, 0xffd2a6);

    // OJOS
    let eyeL = this.add.circle(-6, -28, 3, 0x000000);
    let eyeR = this.add.circle(6, -28, 3, 0x000000);

    // PELO
    let hair = this.add.ellipse(0, -40, 36, 20, 0x2b1b0f);

    // Añadir todo al personaje
    player.add([shadow, body, head, hair, eyeL, eyeR]);


    /* =====================
       OBJETOS
    ===================== */

    let obstacles = this.physics.add.staticGroup();

    obstacles.add(this.add.rectangle(600, 400, 100, 100, 0xff5555));
    obstacles.add(this.add.rectangle(200, 800, 200, 50, 0xff5555));

    this.physics.add.collider(player, obstacles);


    /* =====================
       CAMARA Y CONTROLES
    ===================== */

    this.cameras.main.startFollow(player);
    cursors = this.input.keyboard.createCursorKeys();

    this.add.text(10, 10, 'Tomy World Avatar - Movimiento base', { fill: '#ffffff' }).setScrollFactor(0);
}

function update() {
    player.body.setVelocity(0);

    if (cursors.left.isDown) {
        player.body.setVelocityX(-300);
        facing = -1;
    }
    else if (cursors.right.isDown) {
        player.body.setVelocityX(300);
        facing = 1;
    }

    if (cursors.up.isDown) player.body.setVelocityY(-300);
    else if (cursors.down.isDown) player.body.setVelocityY(300);

    // Girar personaje
    player.scaleX = facing;
}
</script>
</body>
</html>
