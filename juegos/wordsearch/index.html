<!DOCTYPE html><html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sopa de Letras</title><style>
:root{
--bg:#0f172a;
--panel:#1e293b;
--accent:#22c55e;
--gold:#facc15;
--danger:#ef4444;
--neon1:#38bdf8;
--neon2:#a78bfa;
--neon3:#22c55e;
--glass:rgba(255,255,255,.06);
}

body{
margin:0;
font-family:system-ui;
background:linear-gradient(160deg,#020617,#0f172a);
color:white;
display:flex;
justify-content:center;
align-items:center;
min-height:100vh;
}

.screen{display:none;width:min(96vw,700px)}
.active{display:block}

h1,h2{text-align:center;margin:10px}
h1{
font-size:42px;
letter-spacing:2px;
text-shadow:
0 0 10px var(--neon1),
0 0 20px var(--neon2);
 }

button{
width:100%;
padding:16px;
margin:10px 0;
border-radius:18px;
font-size:18px;
color:white;
border:1px solid rgba(255,255,255,.15);
background:linear-gradient(145deg,rgba(255,255,255,.08),rgba(255,255,255,.02));
backdrop-filter:blur(8px);
box-shadow:
0 0 0px transparent,
0 0 10px rgba(56,189,248,.2),
inset 0 0 10px rgba(255,255,255,.05);
transition:.25s;
position:relative;
overflow:hidden;
}
 button:hover{
transform:translateY(-2px);
box-shadow:
0 0 12px var(--neon1),
0 0 24px rgba(56,189,248,.6);
}

button:active{
transform:scale(.96);
box-shadow:
0 0 6px var(--neon2),
0 0 12px var(--neon2);
}
 button::before{
content:"";
position:absolute;
inset:0;
border-radius:18px;
padding:1px;
background:linear-gradient(120deg,var(--neon1),var(--neon2),var(--neon3));
-webkit-mask:
linear-gradient(#000 0 0) content-box,
linear-gradient(#000 0 0);
-webkit-mask-composite:xor;
mask-composite:exclude;
opacity:.6;
animation:borderFlow 4s linear infinite;
}

@keyframes borderFlow{
0%{filter:hue-rotate(0deg)}
100%{filter:hue-rotate(360deg)}
}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:10px;
}

#board{
display:grid;
gap:4px;
touch-action:none;
}

.cell{
background:var(--panel);
display:flex;
justify-content:center;
align-items:center;
aspect-ratio:1/1;
border-radius:10px;
font-weight:bold;
font-size:clamp(14px,4vw,26px);
}

.selected{
background:#334155;
box-shadow:0 0 8px rgba(255,255,255,.25) inset;
}

.found{
color:#fff;
font-weight:bold;
text-shadow:0 0 6px rgba(255,255,255,.6);
}

.word{
background:var(--panel);
padding:6px 10px;
border-radius:10px;
margin:3px;
display:inline-block;
}

.done{background:var(--accent);text-decoration:line-through}

.coin{color:var(--gold)}
.timer{color:#38bdf8}

.shopAvatar{
font-size:40px;
padding:10px;
border-radius:12px;
background:var(--panel);
margin:5px;
}

.locked{opacity:.4}
</style></head><body><!-- MENU --><div id="menu" class="screen active">
<h1>SOPA DE LETRAS</h1>
<div id="avatarDisplay" style="font-size:60px;text-align:center">üôÇ</div>
<button onclick="openMode('kids')">üë∂ Modo Infantil</button>
<button onclick="openMode('adult')">üß† Modo Adulto</button>
<button onclick="openShop()">üõí Tienda</button>
</div><!-- LEVELS --><div id="levels" class="screen">
<h2 id="modeTitle"></h2>
<div id="levelButtons"></div>
<button onclick="show('menu')">‚Üê Volver</button>
</div><!-- GAME --><div id="game" class="screen">
<div class="topbar">
<span id="levelName"></span>
<span class="timer">‚è± <span id="time">0</span></span>
<span class="coin">ü™ô <span id="coins">0</span></span>
</div><div id="wordList"></div>
<div id="board"></div><button onclick="hint()">üí° Pista (-5)</button>
<button onclick="giveUp()">Salir</button>

</div><!-- SHOP --><div id="shop" class="screen">
<h2>Tienda de Avatares</h2>
<div id="shopItems"></div>
<button onclick="show('menu')">‚Üê Volver</button>
</div><script>

// ================= SAVE =================
let save=JSON.parse(localStorage.wordsearch||"{}");
if(!save.coins)save.coins=50;
if(!save.avatar)save.avatar="üôÇ";
localStorage.wordsearch=JSON.stringify(save);

function saveGame(){localStorage.wordsearch=JSON.stringify(save);}

// ================= DATA =================
const WORDS_KIDS=["GATO","PERRO","LEON","OSO","VACA","RANA","SOL","LUNA","MAR","FLOR","ROJO","AZUL","VERDE","MESA","CAMA","SILLA"];
const WORDS_ADULT=["ATOMO","ENERGIA","DATOS","CODIGO","SISTEMA","JAPON","CANADA","BRASIL","EUROPA","AFRICA","OCEANO","GRAVEDAD","NEURONA","SERVIDOR","INTERNET"];

const AVATARS=[
["üôÇ",0],["üòé",50],["ü§ñ",120],["üëΩ",200],["üê±",80],["üê∏",90],["üêµ",140],["ü¶ä",160],["üêº",220]
];

// ================= NAV =================
function show(id){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
updateUI();
}

function updateUI(){
document.getElementById("coins").textContent=save.coins;
document.getElementById("avatarDisplay").textContent=save.avatar;
}


// ================= SHOP =================
function openShop(){
show("shop");
const c=document.getElementById("shopItems");
c.innerHTML="";
AVATARS.forEach(a=>{
let div=document.createElement("div");
div.className="shopAvatar";
div.textContent=a[0];
if(save.coins<a[1])div.classList.add("locked");
div.onclick=()=>{
if(save.coins>=a[1]){
save.avatar=a[0];
saveGame();
updateUI();
}
};
c.appendChild(div);
});
}

// ================= LEVELS =================
let mode,level;
function openMode(m){
mode=m;
show("levels");
document.getElementById("modeTitle").textContent=m=="kids"?"Modo Infantil":"Modo Adulto";
const c=document.getElementById("levelButtons");
c.innerHTML="";
for(let i=1;i<=20;i++){
let b=document.createElement("button");
b.textContent="Nivel "+i;
b.onclick=()=>startLevel(i);
c.appendChild(b);
}
}

// ================= ENGINE =================
let direction=null;
let wordColors=[
"#22c55e","#38bdf8","#f97316","#e879f9","#facc15","#ef4444","#14b8a6"
];
let foundMap={};
let grid=[],size,placed=[],path=[],down=false,time=60,timer;

function randomWord(){
let pool=mode=="kids"?WORDS_KIDS:WORDS_ADULT;
return pool[Math.floor(Math.random()*pool.length)];
}

function makeLevel(lv){
size=8+Math.floor(lv/2)+(mode=="adult"?3:0);
grid=[...Array(size)].map(()=>Array(size).fill(""));
placed=[];
for(let i=0;i<6;i++)place(randomWord());
fill();
draw();
}

function place(word){
let dirs=[[1,0],[0,1],[1,1],[-1,1]];
for(let a=0;a<200;a++){
let [dx,dy]=dirs[Math.floor(Math.random()*4)];
let x=Math.floor(Math.random()*size);
let y=Math.floor(Math.random()*size);
let ok=true;
for(let i=0;i<word.length;i++){
let nx=x+dx*i,ny=y+dy*i;
if(nx<0||ny<0||nx>=size||ny>=size){ok=false;break;}
if(grid[ny][nx]&&grid[ny][nx]!=word[i]){ok=false;break;}
}
if(!ok)continue;
for(let i=0;i<word.length;i++){
let nx=x+dx*i,ny=y+dy*i;
grid[ny][nx]=word[i];
}
placed.push(word);
return;
}
}

function fill(){
const abc="ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ";
for(let y=0;y<size;y++)
for(let x=0;x<size;x++)
if(!grid[y][x])grid[y][x]=abc[Math.floor(Math.random()*abc.length)];
}

function draw(){
const b=document.getElementById("board");
b.style.gridTemplateColumns=`repeat(${size},1fr)`;
b.innerHTML="";

for(let y=0;y<size;y++)
for(let x=0;x<size;x++){

let d=document.createElement("div");
d.className="cell";
d.textContent=grid[y][x];
d.dataset.x=x;
d.dataset.y=y;

// ---- EMPEZAR SELECCION ----
d.onpointerdown=e=>{
down=true;
direction=null;
path=[d];
clear();
d.classList.add("selected");
};

// ---- ARRASTRAR ----
d.onpointerenter=e=>{
if(!down) return;

const first=path[0];
const dx=(+d.dataset.x)-(+first.dataset.x);
const dy=(+d.dataset.y)-(+first.dataset.y);

// si aun no hay direccion ‚Üí permitir explorar
if(direction===null){

// permitir cualquier linea valida
if(dx===0 || dy===0 || Math.abs(dx)===Math.abs(dy)){
let newPath=getLine(first,d);

// evitar micro saltos del dedo
if(newPath.length>=2){
direction=[Math.sign(dx),Math.sign(dy)];
}

clear();
path=newPath;
path.forEach(c=>c.classList.add("selected"));
}

return;
}

// direccion fijada ‚Üí no permitir girar
let newDir=[Math.sign(dx),Math.sign(dy)];
if(newDir[0]!==direction[0] || newDir[1]!==direction[1]) return;

clear();
path=getLine(first,d);
path.forEach(c=>c.classList.add("selected"));
};

// ---- SOLTAR ----
d.onpointerup=e=>{
down=false;
check();
setTimeout(clear,30);
};
b.appendChild(d);
}
}
function getLine(a,b){

let x1=+a.dataset.x, y1=+a.dataset.y;
let x2=+b.dataset.x, y2=+b.dataset.y;

let dx=Math.sign(x2-x1);
let dy=Math.sign(y2-y1);

let cells=[];
let x=x1,y=y1;

while(true){
let c=document.querySelector(`.cell[data-x="${x}"][data-y="${y}"]`);
if(!c)break;
cells.push(c);
if(x===x2 && y===y2)break;
x+=dx; y+=dy;
}

return cells;
}
// ================= GAME =================
function startLevel(lv){
level=lv;
show("game");

document.getElementById("levelName").textContent="Nivel "+lv;

// generar nivel
makeLevel(lv);

// üß† MOSTRAR PALABRAS
const list=document.getElementById("wordList");
list.innerHTML="";
placed.forEach(w=>{
 let d=document.createElement("div");
 d.className="word";
 d.textContent=w;
 list.appendChild(d);
});

startTimer();
}

function startTimer(){
clearInterval(timer);
time=60+level*3;
document.getElementById("time").textContent=time;
timer=setInterval(()=>{
time--;
document.getElementById("time").textContent=time;
if(time<=0)lose();
},1000);
}

function clear(){
path.forEach(c=>{
if(!c.classList.contains("found"))
c.classList.remove("selected");
});
path=[];
}

function check(){

if(path.length===0) return;

// COPIA REAL de lo marcado
let attempt = path.map(c=>c.textContent).join("");
let reverse = [...attempt].reverse().join("");

let idx = placed.findIndex(w => w===attempt || w===reverse);
if(idx===-1) return;

let color = wordColors[idx % wordColors.length];

// pintar tablero
path.forEach(c=>{
c.classList.remove("selected");
c.classList.add("found");
c.style.background=color;
});

// pintar palabra arriba
let wordBox=document.querySelectorAll(".word")[idx];
wordBox.classList.add("done");
wordBox.style.background=color;
wordBox.style.color="#fff";

// guardar encontrada
foundMap[placed[idx]]=true;
placed.splice(idx,1);

save.coins+=3;
saveGame();
updateUI();

if(!placed.length)win();
}

function hint(){

if(save.coins<5)return;

let targetWord=placed[0];
if(!targetWord)return;

for(let y=0;y<size;y++)
for(let x=0;x<size;x++){

for(let [dx,dy] of [[1,0],[0,1],[1,1],[-1,1]]){

let ok=true;
let cells=[];

for(let i=0;i<targetWord.length;i++){
let nx=x+dx*i,ny=y+dy*i;
if(nx<0||ny<0||nx>=size||ny>=size){ok=false;break;}
if(grid[ny][nx]!=targetWord[i]){ok=false;break;}

cells.push(document.querySelector(`.cell[data-x="${nx}"][data-y="${ny}"]`));
}

if(ok){
cells.forEach(c=>c.classList.add("selected"));
save.coins-=5;
saveGame();
updateUI();
return;
}
}
}
}

function win(){
clearInterval(timer);
save.coins+=20;
saveGame();
alert("¬°Nivel superado!");
show("levels");
}

function lose(){
clearInterval(timer);
alert("Tiempo agotado");
show("levels");
}

function giveUp(){
clearInterval(timer);
show("levels");
}

updateUI();

</script></body>
</html>
