<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AzDi Merge</title>

<style>
body{
margin:0;
background:#021014;
font-family:system-ui;
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
overflow:hidden;
}

/* ===== PANTALLA ===== */

#game{
width:340px;
height:520px;
background:linear-gradient(#cfe9ff,#a9d6ff);
border-radius:18px;
position:relative;
overflow:hidden;
box-shadow:0 0 40px #00e5ff44;
}

#ground{
position:absolute;
bottom:0;
width:100%;
height:60px;
background:#7fb36b;
}

/* ===== HUD ===== */

#hud{
position:absolute;
top:8px;
left:0;
right:0;
text-align:center;
font-weight:bold;
color:#003;
}

/* ===== BLOQUES ===== */

.block{
position:absolute;
width:42px;
height:42px;
border-radius:10px;
display:flex;
align-items:center;
justify-content:center;
font-size:18px;
font-weight:bold;
color:#222;
box-shadow:0 3px 0 #0003;
}

/* colores por nivel */

.lvl1{background:#ffe066;}
.lvl2{background:#ffb347;}
.lvl3{background:#ff7a7a;}
.lvl4{background:#d98cff;}
.lvl5{background:#8cdfff;}
.lvl6{background:#8cffb0;}
.lvl7{background:#fff;}

.face{
font-size:18px;
pointer-events:none;
}

/* ===== TUTORIAL ===== */

#tutorial{
position:absolute;
inset:0;
background:#000c;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
text-align:center;
padding:25px;
}

#tutorial button{
margin-top:20px;
padding:12px 20px;
border:none;
border-radius:12px;
background:#00e5ff;
font-weight:bold;
font-size:16px;
}

</style>
</head>
<body>

<div id="game">

<div id="hud">Puntos: <span id="score">0</span></div>

<div id="ground"></div>

<div id="tutorial">
<h2>CÃ³mo jugar</h2>
<p>
Toca la pantalla para soltar cubos.<br><br>
Si dos cubos iguales se tocan ðŸ‘‰ se fusionan y suben de nivel.<br><br>
Cuanto mÃ¡s grandes sean, mÃ¡s puntos dan.<br><br>
Si los cubos llegan arriba... pierdes ðŸ˜ˆ
</p>
<button onclick="start()">Jugar</button>
</div>

</div>

<script>

const game=document.getElementById("game");
const groundY=460;
let blocks=[];
let score=0;
let running=false;

/* ===== CREAR BLOQUE ===== */

function spawn(x){
if(!running) return;

let lvl=Math.random()<0.7?1:2;

let b=document.createElement("div");
b.className="block lvl"+lvl;
b.innerHTML='<div class="face">ðŸ™‚</div>';

let obj={
el:b,
x:x-21,
y:0,
vy:0,
lvl:lvl
};

b.style.left=obj.x+"px";
b.style.top=obj.y+"px";

game.appendChild(b);
blocks.push(obj);
}

/* ===== FISICAS ===== */

function update(){
if(!running) return;

for(let b of blocks){

b.vy+=0.25;
b.y+=b.vy;

/* suelo */
if(b.y>groundY-b.lvl*2){
b.y=groundY-b.lvl*2;
b.vy=0;
}

/* colisiones */
for(let o of blocks){
if(o===b) continue;

if(Math.abs(b.x-o.x)<40 && Math.abs(b.y-o.y)<40){

if(b.lvl===o.lvl && b.vy>=0 && o.vy>=0){

merge(b,o);
return;

}else{
b.y=o.y-40;
b.vy=0;
}
}
}

b.el.style.top=b.y+"px";
}

requestAnimationFrame(update);
}

/* ===== MERGE ===== */

function merge(a,b){

score+=a.lvl*10;
document.getElementById("score").innerText=score;

a.lvl++;
a.el.className="block lvl"+a.lvl;
a.el.innerHTML='<div class="face">ðŸ˜†</div>';

b.el.remove();
blocks.splice(blocks.indexOf(b),1);
}

/* ===== INPUT ===== */

game.addEventListener("click",e=>{
spawn(e.offsetX);
});

/* ===== START ===== */

function start(){
document.getElementById("tutorial").style.display="none";
running=true;
update();
}

</script>

</body>
</html>
