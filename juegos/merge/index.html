<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>AzDi Merge</title>

<style>
body{
margin:0;
overflow:hidden;
background:#05070d;
font-family:Segoe UI,Arial;
color:white;
}

/* estrellas */
canvas#stars{
position:fixed;
top:0;
left:0;
z-index:-1;
}

/* juego */
#game{
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
height:100vh;
}

#score{
color:#00f0ff;
text-shadow:0 0 12px #00f0ff;
margin-bottom:14px;
font-size:26px;
letter-spacing:2px;
}

#board{
background:rgba(20,25,35,.85);
border-radius:28px;
box-shadow:
0 0 80px #00f0ff44,
inset 0 -120px 150px #000000aa;
}

/* menu / gameover */
.overlay{
position:fixed;
inset:0;
display:flex;
align-items:center;
justify-content:center;
backdrop-filter:blur(6px);
}

.card{
background:linear-gradient(180deg,#0b0f18,#121826);
padding:34px;
border-radius:22px;
text-align:center;
width:280px;
box-shadow:0 0 60px #00f0ff66;
animation:float 4s ease-in-out infinite;
}

@keyframes float{
0%,100%{transform:translateY(0)}
50%{transform:translateY(-12px)}
}

.title{
font-size:28px;
color:#00f0ff;
text-shadow:0 0 18px #00f0ff;
margin-bottom:15px;
}

.desc{opacity:.9;margin-bottom:20px;line-height:1.4}

button{
background:linear-gradient(90deg,#00f0ff,#ff00d4);
border:none;
padding:14px 28px;
border-radius:14px;
color:white;
font-weight:bold;
cursor:pointer;
box-shadow:0 0 25px #00f0ff;
}
button:hover{transform:scale(1.08)}
</style>
</head>

<body>

<canvas id="stars"></canvas>

<div id="menu" class="overlay">
<div class="card">
<div class="title">AzDi Merge</div>
<div class="desc">
Fusiona criaturas iguales para evolucionarlas.<br><br>
Si la torre toca arriba... pierdes ðŸ‘€
</div>
<button onclick="start()">JUGAR</button>
</div>
</div>

<div id="gameover" class="overlay" style="display:none">
<div class="card">
<div class="title">GAME OVER</div>
<div id="finalscore" class="desc"></div>
<button onclick="restart()">REINTENTAR</button>
</div>
</div>

<div id="game" style="display:none">
<div id="score">Puntos: 0</div>
<canvas id="board"></canvas>
</div>

<script>
/* estrellas */
const starCanvas=document.getElementById("stars");
const sctx=starCanvas.getContext("2d");

function resizeStars(){
starCanvas.width=innerWidth;
starCanvas.height=innerHeight;
}
window.onresize=resizeStars;
resizeStars();

let stars=[];
for(let i=0;i<150;i++){
stars.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*2,c:`hsl(${Math.random()*360}deg 100% 70%)`});
}

function drawStars(){
sctx.clearRect(0,0,starCanvas.width,starCanvas.height);
for(const s of stars){
sctx.beginPath();
sctx.fillStyle=s.c;
sctx.shadowBlur=10;
sctx.shadowColor=s.c;
sctx.arc(s.x,s.y,s.r,0,Math.PI*2);
sctx.fill();
}
requestAnimationFrame(drawStars);
}
drawStars();

/* tablero */
const canvas=document.getElementById("board");
const ctx=canvas.getContext("2d");

function resizeBoard(){
canvas.width=Math.min(innerWidth*0.9,520);
canvas.height=Math.min(innerHeight*0.75,780);
}
resizeBoard();
window.addEventListener("resize",resizeBoard);

/* juego */
let blocks=[];
let score=0;
let running=false;

const size=56;
const gravity=.45;

const creatures=["ðŸ¥š","ðŸ£","ðŸ¤","ðŸ¥","ðŸ”","ðŸ“","ðŸ¦…","ðŸ²","ðŸ‰","ðŸ‘‘"];
const colors=["#ffe082","#ffd54f","#ffca28","#ffc107","#ff9800","#ff5722","#9c27b0","#673ab7","#2196f3","#00f0ff"];

class Block{
constructor(x,n){
this.x=x;
this.y=0;
this.vy=0;
this.n=n;
}

update(){
this.vy+=gravity;
this.y+=this.vy;

if(this.y+size>canvas.height){
this.y=canvas.height-size;
this.vy=0;
}

for(const other of blocks){
if(other===this)continue;

if(this.x < other.x+size &&
this.x+size > other.x &&
this.y+size > other.y &&
this.y < other.y &&
this.vy>0){

this.y=other.y-size;
this.vy=0;
}
}

/* GAME OVER detect */
if(this.y < 10){
gameOver();
}
}

draw(){
ctx.shadowBlur=25;
ctx.shadowColor=colors[this.n%colors.length];

ctx.fillStyle=colors[this.n%colors.length];
ctx.beginPath();
ctx.roundRect(this.x,this.y,size,size,16);
ctx.fill();

ctx.shadowBlur=0;
ctx.font="28px serif";
ctx.textAlign="center";
ctx.textBaseline="middle";
ctx.fillText(creatures[this.n%creatures.length],this.x+size/2,this.y+size/2);
}
}

function collide(a,b){
return a.x<b.x+size&&a.x+size>b.x&&a.y<b.y+size&&a.y+size>b.y;
}

function merge(){
for(let i=0;i<blocks.length;i++){
for(let j=i+1;j<blocks.length;j++){
let a=blocks[i],b=blocks[j];

if(a.n===b.n && collide(a,b) && Math.abs(a.vy)<1 && Math.abs(b.vy)<1){
blocks.splice(j,1);
blocks.splice(i,1);
blocks.push(new Block(a.x,a.n+1));
score+=10;
document.getElementById("score").innerText="Puntos: "+score;
return;
}
}
}
}

function update(){
if(!running) return;

ctx.clearRect(0,0,canvas.width,canvas.height);

for(const b of blocks)b.update();
merge();
for(const b of blocks)b.draw();

requestAnimationFrame(update);
}

canvas.addEventListener("click",e=>{
if(!running)return;
const rect=canvas.getBoundingClientRect();
const x=e.clientX-rect.left-size/2;
const startLevel=Math.random()<0.8?0:1;
blocks.push(new Block(Math.max(0,Math.min(canvas.width-size,x)),startLevel));
});

/* control */
function start(){
document.getElementById("menu").style.display="none";
document.getElementById("game").style.display="flex";
running=true;
update();
}

function gameOver(){
running=false;
document.getElementById("finalscore").innerText="PuntuaciÃ³n: "+score;
document.getElementById("gameover").style.display="flex";
}

function restart(){
location.reload();
}
</script>

</body>
</html>
