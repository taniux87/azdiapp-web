<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>AzDi Merge</title>

<style>

/* ================== FONDO ARCADE ================== */
body{
margin:0;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
overflow:hidden;
color:white;
font-family:system-ui;

background:
radial-gradient(circle at 20% 20%, #00f7ff22 0%, transparent 40%),
radial-gradient(circle at 80% 70%, #ff00ff22 0%, transparent 40%),
linear-gradient(180deg,#020617,#020617 40%,#01030a);

background-image:
linear-gradient(#00f7ff11 1px, transparent 1px),
linear-gradient(90deg,#00f7ff11 1px, transparent 1px);
background-size: 60px 60px;

animation:bgMove 18s linear infinite;
}

@keyframes bgMove{
0%{background-position:0 0;}
100%{background-position:600px 600px;}
}

/* ================== CONTENEDOR ================== */
.gameBox{
position:relative;
}

/* ================== CANVAS ================== */
canvas{
background:#dfe7ef;
border-radius:18px;
box-shadow:0 0 40px #00f7ff55, inset 0 -80px 0 #9fb7c9;
touch-action:none;
}

/* ================== UI ================== */
.top{
position:absolute;
top:-60px;
width:100%;
text-align:center;
font-weight:bold;
letter-spacing:2px;
}

.score{
font-size:18px;
color:#00f7ff;
text-shadow:0 0 10px #00f7ff;
}

/* ================== PANTALLA INICIO ================== */
.start{
position:absolute;
inset:0;
background:#000c;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
border-radius:18px;
text-align:center;
}

.start h1{
margin:0;
font-size:28px;
color:#00f7ff;
text-shadow:0 0 20px #00f7ff;
}

.start p{
max-width:240px;
opacity:.9;
}

button{
margin-top:15px;
padding:12px 25px;
border:none;
border-radius:12px;
background:linear-gradient(45deg,#00f7ff,#ff00ff);
color:white;
font-size:18px;
cursor:pointer;
}

</style>
</head>

<body>

<div class="gameBox">
<div class="top">
<div class="score">Puntos: <span id="score">0</span></div>
</div>

<canvas id="game" width="320" height="500"></canvas>

<div class="start" id="start">
<h1>AzDi Merge</h1>
<p>
Une cubos del mismo nÃºmero para crear uno mÃ¡s grande.<br><br>
Si la torre llega arribaâ€¦ pierdes ðŸ˜ˆ
</p>
<button onclick="startGame()">JUGAR</button>
</div>

</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const W = canvas.width;
const H = canvas.height;

let blocks=[];
let current=null;
let score=0;
let playing=false;

const size=40;
const gravity=0.4;

function color(n){
const colors=[
"#ffd166","#ef476f","#06d6a0","#118ab2",
"#8338ec","#ff006e","#fb5607","#3a86ff"
];
return colors[(n-1)%colors.length];
}

class Block{
constructor(x,y,n){
this.x=x;
this.y=y;
this.vy=0;
this.n=n;
}
draw(){
ctx.fillStyle=color(this.n);
ctx.beginPath();
ctx.roundRect(this.x,this.y,size,size,10);
ctx.fill();

ctx.fillStyle="#000";
ctx.font="bold 16px Arial";
ctx.textAlign="center";
ctx.textBaseline="middle";
ctx.fillText(this.n,this.x+size/2,this.y+size/2);
}
update(){
this.vy+=gravity;
this.y+=this.vy;

if(this.y>H-size){
this.y=H-size;
this.vy=0;
}
}
}

function spawn(){
current=new Block(W/2-size/2,0,Math.ceil(Math.random()*3));
}

function merge(){
for(let i=0;i<blocks.length;i++){
for(let j=i+1;j<blocks.length;j++){
let a=blocks[i],b=blocks[j];
if(a.n===b.n &&
Math.abs(a.x-b.x)<size &&
Math.abs(a.y-b.y)<size){

a.n++;
blocks.splice(j,1);
score+=a.n*10;
document.getElementById("score").textContent=score;
return;
}
}
}
}

function update(){
ctx.clearRect(0,0,W,H);

blocks.forEach(b=>{
b.update();
b.draw();
});

if(current){
current.draw();
}

merge();
requestAnimationFrame(update);
}

function drop(){
if(!playing) return;
blocks.push(current);
spawn();
}

canvas.addEventListener("mousemove",e=>{
if(!current) return;
const rect=canvas.getBoundingClientRect();
current.x=e.clientX-rect.left-size/2;
});

canvas.addEventListener("touchmove",e=>{
e.preventDefault();
if(!current) return;
const rect=canvas.getBoundingClientRect();
current.x=e.touches[0].clientX-rect.left-size/2;
});

canvas.addEventListener("click",drop);
canvas.addEventListener("touchstart",drop);

function startGame(){
document.getElementById("start").style.display="none";
playing=true;
spawn();
update();
}
</script>

</body>
</html>
