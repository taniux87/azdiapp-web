<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AzDi Runner: Cyber Edition</title>
    <style>
        :root {
            --bg: #0f172a;
            --accent: #00d2ff;
            --neon: #38bdf8;
        }
        body {
            margin: 0;
            background: var(--bg);
            font-family: 'Segoe UI', sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            touch-action: none;
        }
        .header {
            width: 100%;
            background: rgba(15, 23, 42, 0.9);
            padding: 15px;
            text-align: center;
            font-weight: 900;
            letter-spacing: 4px;
            color: var(--accent);
            text-shadow: 0 0 10px var(--accent);
            border-bottom: 2px solid var(--accent);
        }
        .game-container {
            position: relative;
            margin-top: 20px;
            box-shadow: 0 0 50px rgba(0, 210, 255, 0.2);
            border-radius: 20px;
            overflow: hidden;
        }
        canvas {
            display: block;
            background: #000;
            width: min(95vw, 400px);
            height: auto;
            aspect-ratio: 2/3;
        }
        .ui-layer {
            position: absolute;
            top: 10px;
            left: 10px;
            pointer-events: none;
            font-weight: bold;
            font-size: 20px;
            color: var(--gold);
        }
        .info {
            margin-top: 15px;
            opacity: 0.6;
            font-size: 12px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

<div class="header">AZDI RUNNER</div>

<div class="game-container">
    <canvas id="game"></canvas>
</div>

<div class="info">Toca para saltar • Esquiva los muros neón</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Ajuste de resolución interna
canvas.width = 400;
canvas.height = 600;

let started = false;
let gameOver = false;
let score = 0;
let highScore = localStorage.getItem("azdi_highscore") || 0;
let speed = 5;
let frame = 0;

// Propiedades del Jugador
const player = {
    x: 50,
    y: 500,
    w: 40,
    h: 40,
    vy: 0,
    gravity: 0.8,
    jumpForce: -16,
    grounded: true,
    color: "#38bdf8"
};

let obstacles = [];
let clouds = [];

// Crear nubes decorativas
for(let i=0; i<5; i++) {
    clouds.push({ x: Math.random()*canvas.width, y: Math.random()*200, s: Math.random()*0.5 + 0.2 });
}

function spawnObstacle() {
    let h = 40 + Math.random() * 40;
    let w = 20 + Math.random() * 30;
    obstacles.push({ x: canvas.width, y: 540 - h, w: w, h: h, color: "#f472b6" });
}

function drawPlayer() {
    ctx.shadowBlur = 15;
    ctx.shadowColor = player.color;
    ctx.fillStyle = player.color;
    // Cuerpo con bordes redondeados
    ctx.beginPath();
    ctx.roundRect(player.x, player.y, player.w, player.h, 8);
    ctx.fill();
    
    // Ojos
    ctx.shadowBlur = 0;
    ctx.fillStyle = "white";
    ctx.fillRect(player.x + 25, player.y + 10, 8, 8);
    
    // Estela si está saltando
    if(!player.grounded) {
        ctx.globalAlpha = 0.3;
        ctx.fillRect(player.x - 5, player.y + 5, player.w, player.h);
        ctx.globalAlpha = 1;
    }
}

function update() {
    if(!started || gameOver) return;

    frame++;
    speed = 5 + (frame / 1000); // Aumenta dificultad gradualmente

    // Salto y Gravedad
    player.vy += player.gravity;
    player.y += player.vy;

    if(player.y > 500) {
        player.y = 500;
        player.vy = 0;
        player.grounded = true;
    }

    // Obstáculos
    if(frame % Math.max(20, Math.floor(80 - speed * 2)) === 0) {
        spawnObstacle();
    }

    obstacles.forEach((o, i) => {
        o.x -= speed;
        
        // Colisión
        if(player.x < o.x + o.w && player.x + player.w > o.x &&
           player.y < o.y + o.h && player.y + player.h > o.y) {
            endGame();
        }

        if(o.x + o.w < 0) {
            obstacles.splice(i, 1);
            score++;
        }
    });

    // Nubes decorativas
    clouds.forEach(c => {
        c.x -= speed * c.s;
        if(c.x < -100) c.x = canvas.width + 100;
    });
}

function draw() {
    // Fondo Degradado
    const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
    grad.addColorStop(0, "#0f172a");
    grad.addColorStop(1, "#1e293b");
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Dibujar Nubes
    ctx.fillStyle = "rgba(255,255,255,0.1)";
    clouds.forEach(c => {
        ctx.beginPath();
        ctx.arc(c.x, c.y, 30, 0, Math.PI*2);
        ctx.fill();
    });

    // Suelo "Tron"
    ctx.strokeStyle = varProp('--accent');
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(0, 540);
    ctx.lineTo(canvas.width, 540);
    ctx.stroke();
    
    // Líneas de velocidad en el suelo
    ctx.globalAlpha = 0.2;
    for(let i=0; i<10; i++) {
        let lx = (i * 100 - (frame * speed) % 100);
        ctx.strokeRect(lx, 540, 50, 60);
    }
    ctx.globalAlpha = 1;

    // Dibujar Obstáculos
    obstacles.forEach(o => {
        ctx.shadowBlur = 10;
        ctx.shadowColor = o.color;
        ctx.fillStyle = o.color;
        ctx.fillRect(o.x, o.y, o.w, o.h);
    });

    drawPlayer();

    // UI
    ctx.shadowBlur = 0;
    ctx.fillStyle = "white";
    ctx.font = "bold 24px Arial";
    ctx.fillText(`SCORE: ${score}`, 20, 40);
    ctx.font = "14px Arial";
    ctx.fillText(`BEST: ${highScore}`, 20, 65);

    if(!started) {
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0,0,canvas.width, canvas.height);
        ctx.fillStyle = varProp('--accent');
        ctx.textAlign = "center";
        ctx.font = "bold 30px Arial";
        ctx.fillText("READY?", canvas.width/2, canvas.height/2);
        ctx.font = "16px Arial";
        ctx.fillText("TOCA PARA EMPEZAR", canvas.width/2, canvas.height/2 + 40);
        ctx.textAlign = "start";
    }

    if(gameOver) {
        ctx.fillStyle = "rgba(0,0,0,0.8)";
        ctx.fillRect(0,0,canvas.width, canvas.height);
        ctx.fillStyle = "#f472b6";
        ctx.textAlign = "center";
        ctx.font = "bold 40px Arial";
        ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2 - 20);
        ctx.fillStyle = "white";
        ctx.font = "20px Arial";
        ctx.fillText(`Puntos: ${score}`, canvas.width/2, canvas.height/2 + 30);
        ctx.fillText("TOCA PARA REINTENTAR", canvas.width/2, canvas.height/2 + 70);
        ctx.textAlign = "start";
    }
}

function varProp(name) {
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
}

function endGame() {
    gameOver = true;
    if(score > highScore) {
        highScore = score;
        localStorage.setItem("azdi_highscore", highScore);
    }
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

function handleInput() {
    if(!started) {
        started = true;
        return;
    }
    if(gameOver) {
        gameOver = false;
        score = 0;
        speed = 5;
        frame = 0;
        obstacles = [];
        player.y = 500;
        player.vy = 0;
        return;
    }
    if(player.grounded) {
        player.vy = player.jumpForce;
        player.grounded = false;
    }
}

canvas.addEventListener("mousedown", handleInput);
canvas.addEventListener("touchstart", (e) => {
    e.preventDefault();
    handleInput();
}, {passive: false});

loop();
</script>

</body>
</html>
